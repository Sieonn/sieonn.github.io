---
	title: "모듈 시스템, ESM과 CommonJS는 뭐가 다를까?"
toc: true
toc_label: "목차"
toc_sticky: true
category: "JavaScript"
---

## 🚀 시작하며

이번엔 자바스크립트의 **두 가지 대표 모듈 시스템인 ESM과 CommonJS**를 비교하고,  
각각 언제 어떻게 쓰이는지, 어떤 차이가 있는지를 이해하기 쉽게 정리하는 시간을 가져보겠습니다.

---

## 모듈 시스템이란?

### ✅ 정의
> 모듈 시스템이란, **코드를 여러 파일로 나누어 관리하고 재사용할 수 있게 해주는 구조**입니다.

JavaScript는 원래 브라우저용 스크립트였기 때문에,  처음부터 모듈 기능이 없었습니다. 그래서 `jQuery.js`, `main.js` 같은 걸 HTML에 `<script>`로 순서대로 넣는 방식이었습니다.

그러다 보니,
- 전역 변수 충돌
- 관리 어려움
- 의존성 꼬임

같은 문제가 생겼고, 이를 해결하기 위해 **모듈 시스템**이 등장했습니다.

---

## CommonJS란?

### ✅ 정의
> **CommonJS(CJS)**는 Node.js에서 사용하는 모듈 시스템입니다.

- 동기 방식으로 모듈을 불러옵니다.
- 파일 확장자: `.js`
- 기본 문법:
```js
// 가져오기
const fs = require('fs');

// 내보내기
module.exports = { sayHello };
```

### ✅ 특징

- 실행 시점에 `require()`로 **모듈을 동기적으로 로드**
- 주로 Node.js에서 사용
- `require`는 함수이기 때문에 **조건부 로딩**도 가능함

### ✅ 사용 예시

```javascript
// math.js
function add(a, b) {
  return a + b;
}
module.exports = { add };

// main.js
const math = require('./math');
console.log(math.add(1, 2));
```

------

## ESM (ECMAScript Modules)란?

### ✅ 정의

> **ESM**은 ES6(2015)부터 도입된 **자바스크립트 표준 모듈 시스템**입니다.

- 정적(Static) 구조: 코드를 분석할 때 `import`가 미리 분석됨
- 파일 확장자: `.mjs` (또는 `type: "module"`을 설정하면 `.js`도 가능)

### ✅ 문법

```javascript
// 가져오기
import fs from 'fs';

// 내보내기
export const add = (a, b) => a + b;
export default function() { ... }
```

### ✅ 특징

- **비동기 로딩 기반** (호출 시점보다 먼저 파싱)
- **브라우저와 Node.js 모두 사용 가능** (Node는 설정 필요)
- `import`는 **파일 최상단**에서만 사용 가능

### ✅ 사용 예시

```javascript
// math.mjs
export function add(a, b) {
  return a + b;
}

// main.mjs
import { add } from './math.mjs';
console.log(add(2, 3));
```

------

## 주요 차이점 비교

| 항목        | CommonJS (CJS)                | ESM                                  |
| ----------- | ----------------------------- | ------------------------------------ |
| 문법        | `require()`, `module.exports` | `import`, `export`                   |
| 로딩 방식   | 동기(Synchronous)             | 비동기(Asynchronous)                 |
| 해석 시점   | 실행 시 해석                  | 파싱 시 해석 (정적 분석)             |
| 사용 위치   | Node.js                       | 브라우저, Node.js                    |
| 동적 로딩   | 가능 (조건문에서 사용 가능)   | 제한적 (`import()` 동적 import 사용) |
| 파일 확장자 | `.js`                         | `.mjs` 또는 `"type": "module"` 설정  |



------

## Node.js에서 둘 다 쓸 수 있을까?

Node.js는 기본적으로 CommonJS를 사용하지만,
 `package.json`에 다음을 추가하면 ESM도 사용할 수 있습니다.

```json
{
  "type": "module"
}
```

단, 이렇게 하면 `require()`는 더 이상 작동하지 않습니다.
 **CJS와 ESM은 혼용이 어렵기 때문에**, 프로젝트의 시작 단계에서 결정하는 게 좋습니다.

------

## 실무에서 언제 뭘 써야 할까?

| 상황                             | 추천 모듈 시스템                                 |
| -------------------------------- | ------------------------------------------------ |
| 기존 Node.js 백엔드 프로젝트     | CommonJS                                         |
| 새로 만드는 Node.js 프로젝트     | ESM (향후 호환성 ↑)                              |
| 브라우저에서 사용하는 라이브러리 | ESM                                              |
| 번들러 사용 (Vite, Webpack 등)   | 둘 다 가능하지만 ESM 권장                        |
| 라이브러리 배포(NPM 패키지)      | ESM으로 가되, CJS 호환 버전도 같이 배포하면 좋음 |